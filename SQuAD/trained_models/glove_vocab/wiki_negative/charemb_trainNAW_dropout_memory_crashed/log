Using negative samples from wikipedia
Building the model...
Using dropout.
Compiling theano functions:
    train_fn...
    get_start_probs_fn...
    get_end_probs_fn...
Done


Starting epoch 1...

Done 200 batches in 171.07s	training loss:	4.482292
Done 400 batches in 338.73s	training loss:	4.191323
Done 600 batches in 508.28s	training loss:	4.045809
Done 800 batches in 677.41s	training loss:	3.918564
Done 1000 batches in 843.84s	training loss:	3.787956
Done 1200 batches in 1015.66s	training loss:	3.661017
Done 1400 batches in 1187.81s	training loss:	3.566412
Done 1600 batches in 1358.56s	training loss:	3.462454
Done 1800 batches in 1526.08s	training loss:	3.378281
Done 2000 batches in 1692.92s	training loss:	3.306770
Done 2200 batches in 1863.15s	training loss:	3.234139
Done 2400 batches in 2032.62s	training loss:	3.164230
Done 2600 batches in 2203.81s	training loss:	3.100264
Done 2800 batches in 2374.00s	training loss:	3.038029
Done 3000 batches in 2545.90s	training loss:	2.982336
Done 3200 batches in 2713.68s	training loss:	2.934499
Done 3400 batches in 2881.99s	training loss:	2.893326
Done 3600 batches in 3053.38s	training loss:	2.856603
Done 3800 batches in 3220.17s	training loss:	2.820226
Done 4000 batches in 3389.35s	training loss:	2.783682
Done 4200 batches in 3559.10s	training loss:	2.750408
Calculating validation f1...
Done 1000 examples
Done 2000 examples
Done 3000 examples
Done 4000 examples
Done 5000 examples
Done 6000 examples
Done 7000 examples
Done 8000 examples
Done 9000 examples
Done 10000 examples
Predictions done
{'f1': 46.62407924842024, 'exact_match': 37.49290444654683}
F1:  46.6240792484
Done 4400 batches in 4008.14s	training loss:	2.722042
Done 4600 batches in 4177.62s	training loss:	2.693527
Done 4800 batches in 4347.93s	training loss:	2.669588
Done 5000 batches in 4516.14s	training loss:	2.645766
Done 5200 batches in 4685.46s	training loss:	2.622744
Done 5400 batches in 4855.85s	training loss:	2.599166
Done 5600 batches in 5025.65s	training loss:	2.579396
Done 5800 batches in 5195.32s	training loss:	2.557385
Done 6000 batches in 5364.79s	training loss:	2.539601
Done 6200 batches in 5537.50s	training loss:	2.521912
Done 6400 batches in 5705.82s	training loss:	2.506028
Done 6600 batches in 5874.92s	training loss:	2.489081
Done 6800 batches in 6042.74s	training loss:	2.475171
Done 7000 batches in 6209.83s	training loss:	2.459838
Done 7200 batches in 6380.65s	training loss:	2.447418
Done 7400 batches in 6549.70s	training loss:	2.434166
Done 7600 batches in 6720.01s	training loss:	2.421373
Done 7800 batches in 6891.68s	training loss:	2.410956
Done 8000 batches in 7060.70s	training loss:	2.399322
Done 8200 batches in 7229.63s	training loss:	2.389809
Done 8400 batches in 7401.76s	training loss:	2.377350
Calculating validation f1...
Done 1000 examples
Done 2000 examples
Done 3000 examples
Done 4000 examples
Done 5000 examples
Done 6000 examples
Done 7000 examples
Done 8000 examples
Done 9000 examples
Done 10000 examples
Predictions done
{'f1': 41.389566440289876, 'exact_match': 33.973509933774835}
F1:  41.3895664403
Lowering learning rate to  0.0005
Done 8600 batches in 7840.51s	training loss:	2.366416
Done 8800 batches in 8010.19s	training loss:	2.352713
Done 9000 batches in 8181.28s	training loss:	2.340276
Done 9200 batches in 8351.04s	training loss:	2.329979
Done 9400 batches in 8520.98s	training loss:	2.317207
Done 9600 batches in 8690.69s	training loss:	2.305490
Done 9800 batches in 8859.50s	training loss:	2.295173
Done 10000 batches in 9030.53s	training loss:	2.284526
Done 10200 batches in 9201.15s	training loss:	2.274861
Done 10400 batches in 9372.32s	training loss:	2.265738
Done 10600 batches in 9543.33s	training loss:	2.256071
Done 10800 batches in 9714.44s	training loss:	2.247268
Done 11000 batches in 9885.90s	training loss:	2.238849

Training loss:   2.2317737753


Starting epoch 2...

Done 200 batches in 171.55s	training loss:	1.747439
Done 400 batches in 339.19s	training loss:	1.715852
Done 600 batches in 507.17s	training loss:	1.713091
Done 800 batches in 676.01s	training loss:	1.705129
Done 1000 batches in 843.10s	training loss:	1.698804
Done 1200 batches in 1010.56s	training loss:	1.694626
Done 1400 batches in 1180.52s	training loss:	1.688869
Done 1600 batches in 1350.64s	training loss:	1.694373
Calculating validation f1...
Done 1000 examples
Done 2000 examples
Done 3000 examples
Done 4000 examples
Done 5000 examples
Done 6000 examples
Done 7000 examples
Done 8000 examples
Done 9000 examples
Done 10000 examples
Predictions done
{'f1': 52.55197495374681, 'exact_match': 44.53169347209082}
F1:  52.5519749537
Done 1800 batches in 1793.38s	training loss:	1.686671
Done 2000 batches in 1962.82s	training loss:	1.685213
Done 2200 batches in 2132.52s	training loss:	1.690699
Done 2400 batches in 2299.55s	training loss:	1.690680
Done 2600 batches in 2470.58s	training loss:	1.693071
Done 2800 batches in 2642.25s	training loss:	1.688050
Done 3000 batches in 2812.98s	training loss:	1.683899
Done 3200 batches in 2982.98s	training loss:	1.683829
Done 3400 batches in 3152.71s	training loss:	1.683155
Done 3600 batches in 3325.13s	training loss:	1.685153
Done 3800 batches in 3496.40s	training loss:	1.685661
Done 4000 batches in 3665.22s	training loss:	1.685141
Done 4200 batches in 3834.49s	training loss:	1.683144
Done 4400 batches in 4005.28s	training loss:	1.681068
Done 4600 batches in 4176.83s	training loss:	1.678681
Done 4800 batches in 4342.74s	training loss:	1.675753
Done 5000 batches in 4512.71s	training loss:	1.672272
Done 5200 batches in 4681.82s	training loss:	1.671282
Done 5400 batches in 4850.02s	training loss:	1.666989
Done 5600 batches in 5017.69s	training loss:	1.665898
Done 5800 batches in 5188.18s	training loss:	1.664768
Calculating validation f1...
Done 1000 examples
Done 2000 examples
Done 3000 examples
Done 4000 examples
Done 5000 examples
Done 6000 examples
Done 7000 examples
Done 8000 examples
Done 9000 examples
Done 10000 examples
Predictions done
{'f1': 54.04180997772333, 'exact_match': 45.25070955534532}
F1:  54.0418099777
Done 6000 batches in 5625.30s	training loss:	1.661983
Done 6200 batches in 5796.57s	training loss:	1.659073
Done 6400 batches in 5966.31s	training loss:	1.657619
Done 6600 batches in 6138.28s	training loss:	1.657000
Done 6800 batches in 6306.62s	training loss:	1.657267
Done 7000 batches in 6476.77s	training loss:	1.656142
Done 7200 batches in 6645.23s	training loss:	1.655474
Done 7400 batches in 6815.41s	training loss:	1.655612
Done 7600 batches in 6985.14s	training loss:	1.653941
Done 7800 batches in 7156.29s	training loss:	1.652790
Done 8000 batches in 7323.98s	training loss:	1.652686
Done 8200 batches in 7492.98s	training loss:	1.651251
Done 8400 batches in 7660.37s	training loss:	1.651656
Done 8600 batches in 7830.33s	training loss:	1.649792
Done 8800 batches in 8003.90s	training loss:	1.647305
Done 9000 batches in 8172.42s	training loss:	1.647506
Done 9200 batches in 8344.88s	training loss:	1.647957
Done 9400 batches in 8514.25s	training loss:	1.646882
Done 9600 batches in 8683.87s	training loss:	1.646920
Done 9800 batches in 8852.63s	training loss:	1.647400
Done 10000 batches in 9020.76s	training loss:	1.647033
Calculating validation f1...
Done 1000 examples
Done 2000 examples
Done 3000 examples
Done 4000 examples
Done 5000 examples
Done 6000 examples
Done 7000 examples
Done 8000 examples
Done 9000 examples
Done 10000 examples
Predictions done
{'f1': 54.5080185177934, 'exact_match': 46.688741721854306}
F1:  54.5080185178
Done 10200 batches in 9462.28s	training loss:	1.646254
Done 10400 batches in 9629.82s	training loss:	1.645048
Done 10600 batches in 9799.26s	training loss:	1.645204
Done 10800 batches in 9968.20s	training loss:	1.645018
Done 11000 batches in 10137.59s	training loss:	1.644961

Training loss:   1.64412238008


Starting epoch 3...

Done 200 batches in 173.56s	training loss:	1.468168
Done 400 batches in 343.95s	training loss:	1.472547
Done 600 batches in 514.67s	training loss:	1.490401
Done 800 batches in 684.43s	training loss:	1.493319
Done 1000 batches in 853.72s	training loss:	1.492290
Done 1200 batches in 1021.35s	training loss:	1.507216
Done 1400 batches in 1191.66s	training loss:	1.512828
Done 1600 batches in 1359.45s	training loss:	1.514941
Done 1800 batches in 1527.73s	training loss:	1.519456
Done 2000 batches in 1698.56s	training loss:	1.519429
Done 2200 batches in 1871.05s	training loss:	1.517303
Done 2400 batches in 2040.07s	training loss:	1.522570
Done 2600 batches in 2210.44s	training loss:	1.518012
Done 2800 batches in 2380.05s	training loss:	1.518367
Done 3000 batches in 2549.81s	training loss:	1.516742
Done 3200 batches in 2717.34s	training loss:	1.513707
Calculating validation f1...
Done 1000 examples
Done 2000 examples
Done 3000 examples
Done 4000 examples
Done 5000 examples
Done 6000 examples
Done 7000 examples
Done 8000 examples
Done 9000 examples
Done 10000 examples
Predictions done
{'f1': 52.40505702215428, 'exact_match': 44.70198675496689}
F1:  52.4050570222
Lowering learning rate to  0.00025
Done 3400 batches in 3156.45s	training loss:	1.514920
Done 3600 batches in 3326.56s	training loss:	1.515283
Done 3800 batches in 3497.30s	training loss:	1.513140
Done 4000 batches in 3665.90s	training loss:	1.515015
Done 4200 batches in 3840.59s	training loss:	1.513730
Done 4400 batches in 4012.10s	training loss:	1.510401
Done 4600 batches in 4181.50s	training loss:	1.511496
Done 4800 batches in 4349.88s	training loss:	1.510563
Done 5000 batches in 4520.03s	training loss:	1.509169
Done 5200 batches in 4691.22s	training loss:	1.507815
Done 5400 batches in 4861.72s	training loss:	1.506402
Done 5600 batches in 5043.54s	training loss:	1.503521
Done 5800 batches in 5218.21s	training loss:	1.504257
Done 6000 batches in 5393.12s	training loss:	1.503799
Done 6200 batches in 5563.85s	training loss:	1.503367
Done 6400 batches in 5735.43s	training loss:	1.503442
Done 6600 batches in 5908.46s	training loss:	1.503772
Done 6800 batches in 6080.10s	training loss:	1.503256
Done 7000 batches in 6252.85s	training loss:	1.502439
Done 7200 batches in 6423.14s	training loss:	1.501526
Done 7400 batches in 6597.34s	training loss:	1.499886
Calculating validation f1...
Done 1000 examples
Done 2000 examples
Done 3000 examples
Done 4000 examples
Done 5000 examples
Done 6000 examples
Done 7000 examples
Done 8000 examples
Done 9000 examples
Done 10000 examples
Predictions done
{'f1': 57.53276701193533, 'exact_match': 49.3282876064333}
F1:  57.5327670119
Done 7600 batches in 7035.53s	training loss:	1.497928
Done 7800 batches in 7205.18s	training loss:	1.498567
Done 8000 batches in 7380.17s	training loss:	1.498127
Done 8200 batches in 7566.28s	training loss:	1.495978
Done 8400 batches in 7776.19s	training loss:	1.495649
Done 8600 batches in 7945.71s	training loss:	1.492427
Done 8800 batches in 8117.88s	training loss:	1.492896
Done 9000 batches in 8289.61s	training loss:	1.492005
Done 9200 batches in 8517.82s	training loss:	1.491845
Done 9400 batches in 8776.20s	training loss:	1.491164
Done 9600 batches in 9029.76s	training loss:	1.489699
Done 9800 batches in 9291.01s	training loss:	1.488363
Done 10000 batches in 9550.29s	training loss:	1.487130
Done 10200 batches in 9804.60s	training loss:	1.486270
Done 10400 batches in 10061.08s	training loss:	1.485691
Done 10600 batches in 10312.38s	training loss:	1.484447
Done 10800 batches in 10565.00s	training loss:	1.483979
Done 11000 batches in 10821.71s	training loss:	1.481877

Training loss:   1.48233431288


Starting epoch 4...

Done 200 batches in 257.68s	training loss:	1.276184
Done 400 batches in 519.38s	training loss:	1.341237
Done 600 batches in 772.91s	training loss:	1.339779
Calculating validation f1...
Done 1000 examples
Done 2000 examples
Done 3000 examples
Done 4000 examples
Done 5000 examples
Done 6000 examples
Done 7000 examples
Done 8000 examples
Done 9000 examples
Done 10000 examples
Predictions done
{'f1': 58.26939198499487, 'exact_match': 49.735099337748345}
F1:  58.269391985
Done 800 batches in 1384.71s	training loss:	1.348736
Done 1000 batches in 1633.53s	training loss:	1.353297
Done 1200 batches in 1883.65s	training loss:	1.354762
Done 1400 batches in 2134.04s	training loss:	1.360421
Done 1600 batches in 2384.10s	training loss:	1.361222
Done 1800 batches in 2633.67s	training loss:	1.359314
Done 2000 batches in 2881.11s	training loss:	1.357669
Done 2200 batches in 3132.16s	training loss:	1.358874
Done 2400 batches in 3382.25s	training loss:	1.358082
Done 2600 batches in 3632.71s	training loss:	1.351800
Done 2800 batches in 3884.53s	training loss:	1.353342
Done 3000 batches in 4137.50s	training loss:	1.355269
Done 3200 batches in 4386.92s	training loss:	1.356613
Done 3400 batches in 4639.12s	training loss:	1.360974
Done 3600 batches in 4886.66s	training loss:	1.360219
Done 3800 batches in 5137.58s	training loss:	1.359854
Done 4000 batches in 5386.99s	training loss:	1.360476
Done 4200 batches in 5637.64s	training loss:	1.358862
Done 4400 batches in 5888.37s	training loss:	1.359194
Done 4600 batches in 6138.47s	training loss:	1.358291
Done 4800 batches in 6390.03s	training loss:	1.357990
Calculating validation f1...
Done 1000 examples
Done 2000 examples
Done 3000 examples
Done 4000 examples
Done 5000 examples
Done 6000 examples
Done 7000 examples
Done 8000 examples
Done 9000 examples
Done 10000 examples
Predictions done
{'f1': 57.038813132361184, 'exact_match': 48.8647114474929}
F1:  57.0388131324
Lowering learning rate to  0.000125
Done 5000 batches in 7006.13s	training loss:	1.359750
Done 5200 batches in 7258.33s	training loss:	1.357498
Done 5400 batches in 7511.08s	training loss:	1.356694
Done 5600 batches in 7762.51s	training loss:	1.356071
Done 5800 batches in 8014.17s	training loss:	1.356780
Done 6000 batches in 8267.58s	training loss:	1.359442
Done 6200 batches in 8522.41s	training loss:	1.359405
Done 6400 batches in 8772.55s	training loss:	1.360068
Done 6600 batches in 9024.55s	training loss:	1.359787
Done 6800 batches in 9276.85s	training loss:	1.360135
Done 7000 batches in 9538.75s	training loss:	1.362293
Done 7200 batches in 9794.48s	training loss:	1.362366
Done 7400 batches in 10046.09s	training loss:	1.361643
Done 7600 batches in 10299.38s	training loss:	1.360868
Done 7800 batches in 10553.57s	training loss:	1.360233
Done 8000 batches in 10804.12s	training loss:	1.359014
Done 8200 batches in 11059.44s	training loss:	1.359008
Done 8400 batches in 11311.99s	training loss:	1.358314
Done 8600 batches in 11564.80s	training loss:	1.359486
Done 8800 batches in 11820.63s	training loss:	1.359126
Done 9000 batches in 12080.22s	training loss:	1.357803
Calculating validation f1...
Done 1000 examples
Done 2000 examples
Done 3000 examples
Done 4000 examples
Done 5000 examples
Done 6000 examples
Done 7000 examples
Done 8000 examples
Done 9000 examples
Done 10000 examples
Predictions done
{'f1': 59.711818887063295, 'exact_match': 51.390728476821195}
F1:  59.7118188871
Done 9200 batches in 12716.88s	training loss:	1.356074
Done 9400 batches in 12977.33s	training loss:	1.357069
Done 9600 batches in 13240.27s	training loss:	1.355766
Done 9800 batches in 13511.73s	training loss:	1.355803
Done 10000 batches in 13769.22s	training loss:	1.354799
Done 10200 batches in 14032.12s	training loss:	1.354718
Done 10400 batches in 14295.23s	training loss:	1.353876
Done 10600 batches in 14551.47s	training loss:	1.353021
Done 10800 batches in 14815.91s	training loss:	1.352402
Done 11000 batches in 15074.46s	training loss:	1.350632

Training loss:   1.35007816037


Starting epoch 5...

Done 200 batches in 270.01s	training loss:	1.222593
Done 400 batches in 547.53s	training loss:	1.263389
Done 600 batches in 825.95s	training loss:	1.262121
Done 800 batches in 1097.75s	training loss:	1.256187
Done 1000 batches in 1365.04s	training loss:	1.267967
Done 1200 batches in 1645.36s	training loss:	1.270799
Done 1400 batches in 1926.55s	training loss:	1.270504
Done 1600 batches in 2212.07s	training loss:	1.271392
Done 1800 batches in 2498.74s	training loss:	1.268134
Done 2000 batches in 2789.43s	training loss:	1.266628
Done 2200 batches in 3076.94s	training loss:	1.264759
Calculating validation f1...
Done 1000 examples
Done 2000 examples
Done 3000 examples
Done 4000 examples
Done 5000 examples
Done 6000 examples
Done 7000 examples
Done 8000 examples
Done 9000 examples
Done 10000 examples
Predictions done
{'f1': 60.05179867661502, 'exact_match': 51.381267738883636}
F1:  60.0517986766
Done 2400 batches in 3733.92s	training loss:	1.266725
Done 2600 batches in 4029.24s	training loss:	1.267470
Done 2800 batches in 4321.46s	training loss:	1.265786
Done 3000 batches in 4599.16s	training loss:	1.261735
Done 3200 batches in 5030.34s	training loss:	1.262100
Done 3400 batches in 5244.47s	training loss:	1.263966
Done 3600 batches in 5449.60s	training loss:	1.262208
Done 3800 batches in 5651.59s	training loss:	1.260442
Done 4000 batches in 5847.01s	training loss:	1.258224
Done 4200 batches in 6038.56s	training loss:	1.259674
Done 4400 batches in 6227.15s	training loss:	1.261505
Done 4600 batches in 6414.62s	training loss:	1.261016
Done 4800 batches in 6603.20s	training loss:	1.258878
Done 5000 batches in 6790.11s	training loss:	1.258369
Done 5200 batches in 6976.89s	training loss:	1.256133
Done 5400 batches in 7157.81s	training loss:	1.256347
Done 5600 batches in 7342.63s	training loss:	1.255213
Done 5800 batches in 7521.99s	training loss:	1.255849
Done 6000 batches in 7703.06s	training loss:	1.256505
Done 6200 batches in 7883.36s	training loss:	1.255626
Done 6400 batches in 8063.48s	training loss:	1.257553
Calculating validation f1...
Done 1000 examples
Done 2000 examples
Done 3000 examples
Done 4000 examples
Done 5000 examples
Done 6000 examples
Done 7000 examples
Done 8000 examples
Done 9000 examples
Done 10000 examples
Predictions done
{'f1': 58.367094210139925, 'exact_match': 50.14191106906339}
F1:  58.3670942101
Lowering learning rate to  6.25e-05
Done 6600 batches in 8557.51s	training loss:	1.258766
Done 6800 batches in 8735.79s	training loss:	1.259800
Done 7000 batches in 8911.82s	training loss:	1.258529
Done 7200 batches in 9085.98s	training loss:	1.259920
Done 7400 batches in 9259.42s	training loss:	1.261133
Done 7600 batches in 9432.60s	training loss:	1.261705
Done 7800 batches in 9606.18s	training loss:	1.261891
Done 8000 batches in 9782.35s	training loss:	1.261600
Done 8200 batches in 9956.13s	training loss:	1.261292
Done 8400 batches in 10127.62s	training loss:	1.260928
Done 8600 batches in 10298.54s	training loss:	1.261985
Done 8800 batches in 10469.93s	training loss:	1.260082
Done 9000 batches in 10642.40s	training loss:	1.259911
Done 9200 batches in 10811.79s	training loss:	1.259839
Done 9400 batches in 10984.63s	training loss:	1.260372
Done 9600 batches in 11153.94s	training loss:	1.259623
Done 9800 batches in 11325.87s	training loss:	1.260501
Done 10000 batches in 11524.63s	training loss:	1.260134
Done 10200 batches in 11693.12s	training loss:	1.259755
Done 10400 batches in 11862.50s	training loss:	1.260293
Done 10600 batches in 12031.83s	training loss:	1.260674
Calculating validation f1...
Done 1000 examples
Done 2000 examples
Done 3000 examples
Done 4000 examples
Done 5000 examples
Done 6000 examples
Done 7000 examples
Done 8000 examples
Done 9000 examples
Done 10000 examples
Predictions done
{'f1': 61.305890386483114, 'exact_match': 52.620624408703875}
F1:  61.3058903865
Done 10800 batches in 12473.55s	training loss:	1.261021
Done 11000 batches in 12644.41s	training loss:	1.260407

Training loss:   1.2601220164


Starting epoch 6...

Done 200 batches in 172.69s	training loss:	1.140508
Done 400 batches in 339.74s	training loss:	1.153935
Done 600 batches in 509.52s	training loss:	1.173643
Done 800 batches in 679.51s	training loss:	1.180085
Done 1000 batches in 849.75s	training loss:	1.181543
Done 1200 batches in 1018.29s	training loss:	1.195086
Done 1400 batches in 1188.96s	training loss:	1.205000
Done 1600 batches in 1357.72s	training loss:	1.199091
